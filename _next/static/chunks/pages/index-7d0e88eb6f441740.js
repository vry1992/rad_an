(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[332],{2383:()=>{},3686:()=>{},6760:(e,t,n)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(8491)}])},8491:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>m});var l=n(7876),i=n(6734),s=n(8544),o=n(2770);let r=RegExp("([A-Z]{1,4})([0-9]{1,3})$"),a=RegExp("^([A-Z]{1,4})2$"),c=["A","B"],h="РЛС",d=["РЛС РТВ та ЗРВ","РЛС ЗРВ МД","РЛС БСС","Станція КРЕО №4","Станція КРЕО №2","РЛС РТВ та ЗРВ "],u=["00BFFF","FFFF00","0DC0FF"];class y{inputValidator(){var e,t;if(console.log(),!this.book||!(null==(t=this.book)||null==(e=t.Sheets)?void 0:e[h]))throw alert("Відсутній файл, або завантажено не коректний файл"),Error()}read(e){let t=o.LF(e,this.options);return this.book=t,console.log(this.book),this.collectTimeColumns(),this.getColumnKeys(),this.parseWorking()}collectTimeColumns(){this.inputValidator();let e=[],t=null;Object.entries(this.book.Sheets[h]).forEach(n=>{let[l,s]=n,o=a.test(l);if((null==s?void 0:s.z)==="m/d/yy")if(console.log(l),s.w){let e=new Date(s.w),n=!isNaN(e.getTime());if(n){t=e,this.dates.push(e);let n=this.dates.indexOf("placeholder");if(n>=0){let t=(0,i.f)(e,-1);this.dates[n]=t}}else if(!n&&t){let e=(0,i.f)(t,1);this.dates.push(e)}}else if(t){let e=(0,i.f)(t,1);this.dates.push(e)}else this.dates.push("placeholder");"h:mm"===s.z&&s.v>=0&&o&&(0===this.countDayChanged&&this.prevDay++,this.countDayChanged++,24===this.countDayChanged&&(this.countDayChanged=0),s.dayOfMonth=this.prevDay,e.push([l,s])),this.countRowsAmount(l)}),this.timeColumns=Object.fromEntries(e),console.log(this.dates)}countRowsAmount(e){let t=r.exec(e);t&&+t[2]>this.maxRow&&(this.maxRow=+t[2])}getColumnKeys(){return[...new Set(Object.keys(this.book.Sheets[h]).filter(e=>r.exec(e)).map(e=>{var t;return null==(t=r.exec(e))?void 0:t[1]}))]}parseWorking(){let e=[],t=this.book.Sheets[h];for(let i=4;i<this.maxRow;i++){var n,l;let o=(null==(n=t["".concat("C").concat(i)])?void 0:n.v)+" "+(null==(l=t["".concat("D").concat(i)])?void 0:l.v);if(!o||d.includes(o))continue;let r=null,a=null,h=[],y=this.getColumnKeys().reduce((e,n)=>{var l,d,y;if(n&&c.includes(n)||!this.timeColumns["".concat(n,"2")])return e;r=this.timeColumns["".concat(n,"2")],a=this.dates[r.dayOfMonth-1];let g=null==(y=t["".concat(n).concat(i)])||null==(d=y.s)||null==(l=d.fgColor)?void 0:l.rgb,p=u.includes(g);if(!a)return e;let x=(0,s.GP)(a,"dd.LL.yyyy");h.includes(x)||h.push(x),e.name=o;let m=e.working.get(x)||[];return e.working.set(x,[...m,{isWorking:p,currentTime:null==r?void 0:r.w,currentDay:(0,s.GP)(a,"dd.LL.yyyy"),cellId:"".concat(n).concat(i),key:h.length}]),(null==r?void 0:r.w)==="23:00"&&e.working.set(x,[...e.working.get(x),{isWorking:p,currentTime:"24:00",currentDay:(0,s.GP)(a,"dd.LL.yyyy"),cellId:"".concat(n).concat(i),key:h.length}]),e},{name:"",working:new Map});e[i]=y}return e.filter(Boolean)}constructor(){this.book=null,this.options={type:"array",sheets:h,cellStyles:!0,sheetStubs:!0,FS:"||||"},this.countDayChanged=0,this.prevDay=0,this.timeColumns={},this.dates=[],this.maxRow=0,this.maxDayOfMonth=1}}let g=new y;var p=n(4232);let x=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,22,21,23,24];function m(){let[e,t]=(0,p.useState)([]);return(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)("div",{style:{display:"flex"},children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("input",{type:"file",onChange:e=>{let n=e.target.files[0],l=new FileReader;l.onload=e=>{var n;if(null==e||null==(n=e.target)?void 0:n.result){let n=new Uint8Array(e.target.result);t(g.read(n))}},l.readAsArrayBuffer(n)},accept:".xlsx, .xlsm"}),(0,l.jsx)("div",{children:e.map((e,t)=>(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{id:"".concat(t),style:{textAlign:"center",padding:30},children:e.name}),(0,l.jsx)("table",{children:(0,l.jsx)("tbody",{children:e.working.entries().map((t,n)=>{let[i,s]=t;return(0,l.jsxs)(p.Fragment,{children:[0===n&&(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{style:{width:"50px",height:"15px"}}),s.map((e,t)=>(0,l.jsx)("td",{style:{width:"50px",height:"15px"},children:function(e){let t=Math.floor(e).toString().padStart(2,"0");return"".concat(t,":00")}(x[t])},t))]}),(0,l.jsx)("tr",{children:s.map((e,t)=>{let{isWorking:n}=e;return(0,l.jsxs)(p.Fragment,{children:[0===t&&(0,l.jsx)("td",{style:{width:"150px",height:"30px",textAlign:"center",textDecoration:"underline"},children:i}),(0,l.jsx)("td",{style:{width:"50px",height:"15px",background:n?"red":"none",border:"1px solid grey"}})]},"".concat(i,"_").concat(t))})},"".concat(e.name,"_").concat(i))]},"".concat(i,"____").concat(n))})})},e.name)]},e.name)}))})]}),(0,l.jsx)("div",{style:{position:"fixed",right:0,top:0,width:400,overflow:"scroll-x"},children:e.map((e,t)=>e.name?(0,l.jsx)("a",{href:"#".concat(t),style:{textAlign:"center",padding:5,display:"inline-block"},children:e.name},"___".concat(t,"___").concat(e.name)):null)})]})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[509,537,636,593,792],()=>t(6760)),_N_E=e.O()}]);